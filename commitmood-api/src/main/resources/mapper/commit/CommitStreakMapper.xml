<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.commitmood.domain.commit.mapper.CommitStreakMapper">

    <resultMap id="dailyCommitCountResultMap"
               type="com.ssafy.commitmood.domain.commit.mapper.CommitStreakMapper$DailyCommitCount">
        <result property="commitDate" column="COMMIT_DATE"/>
        <result property="commitCount" column="COMMIT_COUNT"/>
    </resultMap>

    <!-- 특정 기간 동안의 일별 커밋 수 조회 -->
    <select id="findDailyCommitCounts" resultMap="dailyCommitCountResultMap">
        SELECT
            DATE(cl.COMMITTED_AT) AS COMMIT_DATE,
            COUNT(*) AS COMMIT_COUNT
        FROM COMMIT_LOG cl
        WHERE cl.AUTHOR_USER_ACCOUNT_ID = #{userAccountId}
          AND DATE(cl.COMMITTED_AT) BETWEEN #{startDate} AND #{endDate}
        GROUP BY DATE(cl.COMMITTED_AT)
        ORDER BY COMMIT_DATE
    </select>

</mapper>